<div class="container">
  <div class="header">
    <p class="main">Announcement</p>
    <orms-button
      [text]="'Add Announcement'"
      [bgColor]="'#c1eb92'"
      [color]="'#323f24'"
      [hoverBGColor]="'#d4eeb6'"
      [hoverColor]="'#0e0d0d'"
      [borderRadius]="10"
      [borderColor]="'#4c5740'"
      [showBorder]="true"
      (click)="toggleForm()"
    ></orms-button>
  </div>

  <hr class="custom-line" />

  <!-- 游녢 Form Section -->
  <div class="blank-space" [class.visible]="showForm">
    <form [formGroup]="announcementForm" class="form-grid" novalidate>
      
      <!-- 游릴 Title Field -->
      <div class="form-item title-field">
        <orms-text-box
          [label]="'Title'"
          [placeHolder]="'Enter the title'"
          [isRequired]="true"
          [isSave]="isSaveClicked"
          formControlName="title"
          [ngClass]="{ 'error-border': isSaveClicked && f['title'].invalid }"
        ></orms-text-box>
      </div>

      <!-- 游릴 Priority Dropdown -->
      <div class="form-item">
        <orms-drop-down
          [label]="'Priority'"
          [placeHolder]="'Select severity type'"
          [isRequired]="true"
          [options]="[
            { value: 'high', name: 'High' },
            { value: 'medium', name: 'Medium' },
            { value: 'low', name: 'Low' }
          ]"
          [isSave]="isSaveClicked"
          formControlName="priority"
          [ngClass]="{ 'error-border': isSaveClicked && f['priority'].invalid }"
        ></orms-drop-down>
      </div>

      <!-- 游릴 Expire Date -->
      <div class="form-item">
     <orms-calendar
        [label]="'Expires On'"
        [isRequired]="true"
        [isSave]="isSaveClicked"
        formControlName="expireDate"
        ></orms-calendar>
      </div>

      <!-- 游릴 Description -->
      <div class="form-item desc-field">
        <orms-text-area
          [label]="'Description'"
          [Placeholder]="'Enter description'"
          [isRequired]="true"
          [isSave]="isSaveClicked"
          [showBorder]="true"
          formControlName="description"
          [ngClass]="{ 'error-border': isSaveClicked && f['description'].invalid }"
        ></orms-text-area>
      </div>

      <!-- 游릴 Footer Buttons -->
      <div class="form-footer">
        <orms-button
          [text]="'Clear'"
          [color]="'red'"
          [hoverBGColor]="'#f2b6b6'"
          [hoverColor]="'Black'"
          [borderRadius]="8"
          [borderColor]="'red'"
          [showBorder]="true"
          (click)="announcementForm.reset()"
        ></orms-button>

        <orms-button
          [text]="'Save'"
          [bgColor]="'green'"
          [color]="'white'"
          [hoverBGColor]="'#519c51'"
          [hoverColor]="'white'"
          [borderRadius]="8"
          [showBorder]="false"
          (click)="onSave()"
        ></orms-button>
      </div>
    </form>
  </div>

  <!-- 游녢 Existing Announcement Cards -->
 <div class="blank-space-two anycard">
    <h3 class="card-title">Recent Announcements</h3>
 
    @for (announcement of otherAnnouncements; track announcement; let last = $last) {
      <div class="announcement-item">
        <div class="title-row">
          <h4 class="title">{{ announcement.title }}</h4>
          <orms-chip [text]="announcement.priority" [color]="
              announcement.priority === 'high'
                ? '#b38742'
 : announcement.priority === 'low' ? '#23816c': '#aa355b'"
            [activeColor]="announcement.priority === 'medium'? '#b38742': announcement.priority === 'low' ? '#23816c': '#aa355b'"
            [activeBGColor]="announcement.priority === 'medium'? '#fef9c2': announcement.priority === 'low'? '#dbfce7': '#ffe2e2'"
            [bgColor]="announcement.priority === 'medium' ? '#fef9c2' : announcement.priority === 'low' ? '#dbfce7' : '#ffe2e2'">
          </orms-chip>
        </div>
        <p class="description">{{ announcement.description }}</p>
        <div class="footer-row">
          <div class="date">
            <span class="expire-label">Expire on:</span>
            <span class="expire-date">{{ formatDate(announcement.expireDate) }}</span>
          </div>
          <div class="footer">
            <orms-button [text]="'Edit'" [bgColor]="'#3965e9'" [color]="'white'" [hoverBGColor]="'#3965e9'"
            [hoverColor]="'black'" [borderRadius]="8" [showBorder]="false"></orms-button>
            <orms-button [text]="'Delete'" [bgColor]="'red'" [color]="'white'" [hoverBGColor]="'red'"
            [hoverColor]="'black'" [borderRadius]="8" [showBorder]="false"></orms-button>
          </div>
        </div>
      </div>
      @if (!last) {
        <hr class="custom-line" />
      }
    }
  </div>
  <!-- 游댒 Error Popup -->
<app-confirm-popup
  *ngIf="showErrorPopup"
  [title]="''"
  [changeIcon]="''"
  [borderColor]="'red'"
  [label]="'You must fill all the fields'"
  (close)="handlePopupClose($event)">
</app-confirm-popup>


</div>
